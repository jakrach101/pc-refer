<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß Palliative Care</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&family=TH+Sarabun+New:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <h1>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß Palliative Care</h1>
      <p class="sub">MVP v1 ‚Äî ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á <span id="saveStatus" class="save-status"></span></p>
    </header>
    <main>
      <section class="card">
        <h2>‡∏™‡∏ñ‡∏≤‡∏ô‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• & ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</h2>
        <div class="grid">
          <label>
            ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á
            <input id="fromFacility" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡πÄ‡∏ö‡∏≤‡πÉ‡∏à ‡∏£‡∏û.‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå" />
          </label>
          <label>
            ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (Primary: ‡∏£‡∏û.‡∏™‡∏ï. ‡πÉ‡∏Å‡∏•‡πâ‡∏ö‡πâ‡∏≤‡∏ô)
            <input id="toFacilityPrimary" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏û.‡∏™‡∏ï.‡∏ö‡πâ‡∏≤‡∏ô..." />
          </label>
          <label>
            ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (Secondary: ‡∏£‡∏û‡∏ä.)
            <input id="toFacilitySecondary" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏û‡∏ä...." />
          </label>
          <label>
            ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (Tertiary: ‡∏£‡∏û‡∏ó./‡∏£‡∏û‡∏®.)
            <input id="toFacilityTertiary" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏û‡∏ó.... / ‡∏£‡∏û‡∏®...." />
          </label>
          <label>
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠
            <input id="refDate" type="date" />
          </label>
        </div>
      </section>

      <section class="card">
        <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h2>
        <div class="grid">
          <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• <input id="pName" aria-label="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢" /></label>
          <label>‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ) <input id="pAge" type="number" min="0" aria-label="‡∏≠‡∏≤‡∏¢‡∏∏‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ" aria-describedby="age-hint" /></label>
          <label>HN <input id="pHN" aria-label="Hospital Number" /></label>
          <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô <input id="pCID" aria-label="‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å" maxlength="17" /></label>
          <label class="span-2">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà <input id="pAddress" aria-label="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢" /></label>
        </div>
        <div>
          <h3 style="margin:12px 0 8px 2px;font-size:16px">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏• <span class="muted" style="font-size:13px">(‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å = ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏´‡∏•‡∏±‡∏Å)</span></h3>
          <div id="caregiversList"></div>
          <button id="addCaregiver" type="button" class="small" style="margin-top:8px">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</button>
        </div>
      </section>

      <section class="card">
        <h2>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠</h2>
        <div id="purposeChips" class="chips">
          <label><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏ö‡πâ‡∏≤‡∏ô"> ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏ö‡πâ‡∏≤‡∏ô</label>
          <label><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡∏õ‡∏£‡∏∞‡∏Ñ‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Ñ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô"> ‡∏î‡∏π‡πÅ‡∏•‡∏õ‡∏£‡∏∞‡∏Ñ‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Ñ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô</label>
          <label><input type="checkbox" value="‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ö‡πâ‡∏≤‡∏ô"> ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ö‡πâ‡∏≤‡∏ô</label>
          <label><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏¢‡∏∞‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï"> ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏¢‡∏∞‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</label>
        </div>
      </section>

      <section class="card">
        <h2>Advance Care Plan (ACP)</h2>
        <div id="acpChips" class="chips">
          <label><input type="checkbox" value="No CPR"> No CPR</label>
          <label><input type="checkbox" value="No ETT"> No ETT</label>
          <label><input type="checkbox" value="Place of death at home"> Place of death at home</label>
          <label><input type="checkbox" value="Off ETT at home"> Off ETT at home</label>
          <label><input type="checkbox" value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à"> ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à</label>
        </div>
      </section>

      <section class="card">
        <h2>‡∏à‡∏¥‡∏ï‡∏™‡∏±‡∏á‡∏Ñ‡∏°‚Äì‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì</h2>
        <div class="grid">
          <label>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢/‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå <input id="informedBy" /></label>
          <label>‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢
            <select id="living">
              <option value="">‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äî</option>
              <option>‡∏≠‡∏¢‡∏π‡πà‡∏•‡∏≥‡∏û‡∏±‡∏á</option>
              <option>‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</option>
              <option>‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏ö‡∏à‡πâ‡∏≤‡∏á</option>
            </select>
          </label>
          <label class="span-2">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡πà‡∏ß‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏•/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ <input id="concerns" /></label>
          <label class="span-2">Perception (‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢) <input id="perceptionPatient" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‚Ä¶" /></label>
          <label class="span-2">Perception (‡∏ç‡∏≤‡∏ï‡∏¥) <input id="perceptionFamily" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ç‡∏≤‡∏ï‡∏¥‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‚Ä¶" /></label>
          <label class="span-2">Conspiracy of silence <input id="conspiracy" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏°‡∏µ/‡πÑ‡∏°‡πà‡∏°‡∏µ + ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î" /></label>
        </div>
      </section>

      <section class="card">
        <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</h2>
        <div class="grid">
          <label class="span-2">Diagnosis <input id="dx" aria-label="‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÇ‡∏£‡∏Ñ" /></label>
          <label>PPS (%) <input id="pps" type="number" min="10" max="100" step="10" aria-label="Palliative Performance Scale ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå" /></label>
          <label>GFR (mL/min/1.73m¬≤) <input id="gfr" type="number" min="0" max="200" step="1" placeholder="eGFR (mL/min/1.73m¬≤)" aria-label="Glomerular Filtration Rate" /></label>
          <label>Hct (%) <input id="hct" type="number" min="0" max="100" aria-label="Hematocrit ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå" /></label>
          <label>Alb (g/dL) <input id="alb" type="number" step="0.1" aria-label="Albumin ‡∏Å‡∏£‡∏±‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏ã‡∏¥‡∏•‡∏¥‡∏ï‡∏£" /></label>
        </div>
        <div class="grid">
          <label>Metastasis</label>
          <div id="metastasisChips" class="chips span-2">
            <label><input type="checkbox" value="Bone"> Bone</label>
            <label><input type="checkbox" value="Brain"> Brain</label>
            <label><input type="checkbox" value="Liver"> Liver</label>
            <label><input type="checkbox" value="Lung"> Lung</label>
            <label><input type="checkbox" value="Lymph nodes"> Lymph nodes</label>
          </div>
          <label>‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</label>
          <div id="treatmentChips" class="chips span-2">
            <label><input type="checkbox" value="Chemo"> Chemo</label>
            <label><input type="checkbox" value="RT"> RT</label>
            <label><input type="checkbox" value="Surgery"> Surgery</label>
            <label><input type="checkbox" value="Targeted therapy"> Targeted</label>
            <label><input type="checkbox" value="Immunotherapy"> Immuno</label>
          </div>
        </div>
      </section>

      <section class="card">
        <h2>Symptoms & Vital signs</h2>
        <div class="grid">
          <label>‡∏õ‡∏ß‡∏î‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì <input id="painSite" aria-label="‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì‡∏ó‡∏µ‡πà‡∏õ‡∏ß‡∏î" /></label>
          <label>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏ß‡∏î (PS) <input id="painScore" type="number" min="0" max="10" aria-label="Pain Score 0-10" /></label>
          <label>Dyspnea score <input id="dyspneaScore" type="number" min="0" max="10" aria-label="Dyspnea Score 0-10" /></label>
          <label>SpO2 (%) <input id="spo2" type="number" min="0" max="100" aria-label="Oxygen Saturation ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå" /></label>
          <label>RR (‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ) <input id="vsRR" type="number" min="0" aria-label="Respiratory Rate ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ô‡∏≤‡∏ó‡∏µ" /></label>
          <label>BP (mmHg) <input id="bp" placeholder="‡πÄ‡∏ä‡πà‡∏ô 120/80" aria-label="Blood Pressure" /></label>
          <label>HR (‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ) <input id="hr" type="number" min="0" aria-label="Heart Rate ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ô‡∏≤‡∏ó‡∏µ" /></label>
          <label>GCS <input id="gcs" placeholder="‡πÄ‡∏ä‡πà‡∏ô E4V5M6" aria-label="Glasgow Coma Scale" /></label>
          <label>‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ/‡∏≠‡∏≤‡πÄ‡∏à‡∏µ‡∏¢‡∏ô</label>
          <div id="nauseaChips" class="chips span-2">
            <label><input type="radio" name="nausea" value="‡∏°‡∏µ"> ‡∏°‡∏µ</label>
            <label><input type="radio" name="nausea" value="‡πÑ‡∏°‡πà‡∏°‡∏µ"> ‡πÑ‡∏°‡πà‡∏°‡∏µ</label>
          </div>
          <label class="span-2">‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ <input id="others" /></label>
        </div>
      </section>

      <section class="card">
        <h2>‡πÅ‡∏ú‡∏ô‡∏¢‡∏≤ / ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h2>
        <div class="row">
          <label class="muted">Type</label>
          <div id="orderTypeChips" class="chips">
            <label><input type="radio" name="orderType" value="po" checked> PO/SL</label>
            <label><input type="radio" name="orderType" value="po_prn"> PO/SL PRN</label>
            <label><input type="radio" name="orderType" value="inj_prn"> Inject PRN</label>
            <label><input type="radio" name="orderType" value="inf"> Infusion</label>
          </div>
        </div>

        <div id="singleOrder">
          <div class="med-order-form">
            <!-- Main Input Row -->
            <div class="med-input-row">
              <div class="med-field med-field-grow">
                <label class="med-label">‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤</label>
                <input id="drugName" placeholder="‡πÄ‡∏ä‡πà‡∏ô MST 30 mg/tab" list="formulary" />
              </div>

              <div class="med-field">
                <label class="med-label">
                  ‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤ (dose)
                  <span id="doseUnitLabel" class="unit-badge"></span>
                </label>
                <input id="dose" type="number" min="0" step="0.5" placeholder="1" />
              </div>

              <div class="med-field med-field-grow">
                <label class="med-label">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ</label>
                <input id="freq" placeholder="q12h, bid, tid" list="freqList" />
              </div>

              <div class="med-field med-field-qty">
                <label class="med-label">
                  ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô
                  <span id="qtyPackLabel" class="pack-info"></span>
                </label>
                <div class="qty-input-wrapper">
                  <input id="qty" type="number" min="0" step="1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" required />
                  <span class="qty-calc-icon" id="showCalc" title="‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô">üßÆ</span>
                </div>
              </div>

              <div class="med-actions">
                <button id="addOne" type="button" class="btn-add">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏≤</button>
                <button id="clearOne" type="button" class="btn-clear">‡∏•‡πâ‡∏≤‡∏á</button>
              </div>
            </div>

            <!-- Calculator Panel (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å üßÆ) -->
            <div id="calcPanel" class="calc-panel hidden">
              <div class="calc-panel-header">
                <span class="calc-panel-title">üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏¢‡∏≤</span>
                <button id="closeCalc" class="calc-close">‚úï</button>
              </div>
              <div class="calc-panel-body">
                <div class="calc-row">
                  <input id="calcDoseInput" type="number" min="0" step="0.5" placeholder="Dose" class="calc-input-small" />
                  <span class="calc-separator">√ó</span>
                  <input id="calcFreqInput" placeholder="q12h, tid" class="calc-input-medium" />
                  <span class="calc-separator">√ó</span>
                  <input id="medDuration" type="number" min="1" max="365" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô" class="calc-input-small" />
                  <span class="calc-info">‡∏ß‡∏±‡∏ô</span>
                  <button id="calcMedQty" type="button" class="btn-calc">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
                </div>
                <div id="calcResultRow" class="calc-result-row hidden">
                  <span class="calc-result-text">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: <strong id="calcResultValue">-</strong></span>
                  <button id="applyCalcResult" type="button" class="btn-apply-calc">‚úì ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ</button>
                </div>
              </div>
            </div>
          </div>

          <datalist id="formulary"></datalist>
          <datalist id="freqList"></datalist>
        </div>

        <div id="infusionOrder" class="hidden">
          <div class="row preset-bar">
            <button id="presetCSCI1" type="button">Preset: Morphine (CSCI)</button>
            <button id="presetCSCI2" type="button">Preset: Morphine + Midazolam</button>
            <button id="presetCSCI3" type="button">Preset: Morphine + Midazolam + Hyoscine</button>
          </div>
          <div id="mixRows"></div>
          <datalist id="formularyIvSc"></datalist>
          <div class="row" id="mixBar">
            <select id="mixRoute" title="Route"><option value="CSCI">CSCI</option><option value="IV">IV</option></select>
            <select id="mixDevice" title="Device"></select>
            <input id="mixDiluent" placeholder="Diluent (‡πÄ‡∏ä‡πà‡∏ô NSS)" title="Diluent" />
            <input id="mixFinalVol" type="number" min="1" placeholder="Vol (mL)" title="Final volume" />
            <input id="mixDuration" type="number" min="1" value="24" placeholder="Dur (h)" title="Duration" />
            <span id="mixRateWrap" class="hidden"><input id="mixRate" type="number" min="0" step="0.1" placeholder="mL/h" title="Rate (mL/h)" /></span>
            <span id="mixMmWrap"><input id="mixMmPerHr" type="number" min="0" step="0.1" placeholder="mm/h" title="Set speed (mm/h)" /></span>
            <span id="mixDiaWrap"><input id="mixDia" type="number" min="0" step="0.1" placeholder="√ò mm" title="Syringe diameter (mm)" /></span>
            <input id="mixSite" placeholder="Site" title="Site" />
            <input id="mixQty" type="number" min="1" placeholder="#" title="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (bag)" />
          </div>
          <div class="row">
            <button id="mixAdd" class="btn-primary" type="button">Add to Med List</button>
          </div>
        </div>

        <div id="medList"></div>
        <div id="tddSummary" class="sub"></div>
      </section>


      

      <details class="card">
        <summary>Conversion: Oral Morphine ‚Üí Fentanyl patch</summary>
        <div class="grid mt-8">
          <label>Oral Morphine (mg/24h) <input id="oralMorphine24" type="number" min="0" /></label>
          <label>Opioid-na√Øve?
            <select id="isNaiveForPatch">
              <option>No</option>
              <option>Yes</option>
            </select>
          </label>
        </div>
        <div class="row">
          <button id="convSuggest" type="button">Suggest patch</button>
        </div>
        <div id="convResult"></div>
      </details>

      <section class="card">
        <h2>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° (Follow-up)</h2>
        <div class="grid">
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input id="fuDate" type="date" /></label>
          <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° <input id="fuSite" /></label>
          <label>‡πÇ‡∏ó‡∏£ <input id="fuTel" /></label>
        </div>
      </section>

      <section class="actions">
        <button id="copyHis" type="button">Copy HIS Note</button>
        <button id="previewBtn" type="button">‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á PDF</button>
        <button id="exportPdf" type="button">Export PDF</button>
        <button id="exportData" type="button">Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (.json)</button>
        <button id="exportExcel" type="button">Export ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≤ (Excel)</button>
        <button id="importData" type="button">Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (.json)</button>
        <button id="openDrive" type="button">‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Drive</button>
        <button id="togglePrintSettings" type="button">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå</button>
        <input id="importFile" type="file" accept="application/json,.json" style="display:none" />
        <button id="clearAll" class="danger" type="button">‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      </section>

      <!-- Print Settings Panel -->
      <section id="printSettingsPanel" class="card print-settings-panel hidden">
        <div class="print-settings-header">
          <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå</h2>
          <button id="closePrintSettings" class="settings-close">‚úï</button>
        </div>

        <div class="print-settings-grid">
          <!-- Typography Settings -->
          <div class="settings-group">
            <h3 class="settings-group-title">üìù ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î</h3>
            <div class="settings-row">
              <label class="settings-label">
                <span>Font Family</span>
                <select id="printFont" class="settings-input">
                  <option>TH SarabunPSK</option>
                  <option>TH Sarabun New</option>
                  <option>Sarabun</option>
                  <option>Noto Sans Thai</option>
                  <option>Tahoma</option>
                  <option>Arial</option>
                  <option>System</option>
                </select>
              </label>

              <label class="settings-label">
                <span>Font Size <span class="settings-value" id="printSizeValue">16pt</span></span>
                <input id="printSize" type="range" min="4" max="20" step="0.5" value="16" class="settings-slider" />
              </label>

              <label class="settings-label">
                <span>Line Height <span class="settings-value" id="printLineHeightValue">1.35</span></span>
                <input id="printLineHeight" type="range" min="1.10" max="1.60" step="0.05" value="1.35" class="settings-slider" />
              </label>
            </div>
          </div>

          <!-- Layout Settings -->
          <div class="settings-group">
            <h3 class="settings-group-title">üìÑ ‡πÄ‡∏•‡∏¢‡πå‡πÄ‡∏≠‡∏≤‡∏ï‡πå</h3>
            <div class="settings-row">
              <label class="settings-label">
                <span>Page Width <span class="settings-value" id="printWidthValue">190mm</span></span>
                <input id="printWidth" type="range" min="150" max="200" step="5" value="190" class="settings-slider" />
              </label>

              <label class="settings-toggle">
                <input id="fitOnePage" type="checkbox" />
                <span class="toggle-label">
                  <strong>Fit to 1 Page</strong>
                  <small>‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ 1 ‡∏´‡∏ô‡πâ‡∏≤</small>
                </span>
              </label>

              <label class="settings-toggle">
                <input id="printWordLike" type="checkbox" checked />
                <span class="toggle-label">
                  <strong>Word-like Layout</strong>
                  <small>‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö MS Word</small>
                </span>
              </label>
            </div>
          </div>

          <!-- Footer Settings -->
          <div class="settings-group">
            <h3 class="settings-group-title">üìå ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡πâ‡∏≤‡∏¢</h3>
            <div class="settings-row">
              <label class="settings-toggle">
                <input id="printShowPrinted" type="checkbox" checked />
                <span class="toggle-label">
                  <strong>‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå</strong>
                  <small>Printed on...</small>
                </span>
              </label>

              <label class="settings-toggle">
                <input id="printShowPgn" type="checkbox" />
                <span class="toggle-label">
                  <strong>‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤</strong>
                  <small>Page X of Y</small>
                </span>
              </label>
            </div>
          </div>
        </div>

        <div class="print-settings-footer">
          <button id="resetPrintSettings" type="button" class="btn-reset">‚Ü∫ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</button>
          <button id="applyPrintSettings" type="button" class="btn-primary">‚úì ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>
      </section>

      <section id="hisBlock" class="card">
        <h2>HIS Note (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)</h2>
        <pre id="hisText"></pre>
      </section>

      <section id="printDoc" class="card pdf">
        <div id="pageEstimate" class="page-estimate"></div>
        <div class="print-header">
          <img src="logo.png" class="logo" alt="logo" />
          <div class="heading"><h2>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ Palliative Care</h2></div>
        </div>
        <div class="pdf-meta">
          <div class="kv">
            <div class="k">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á</div>
            <div class="v"><span data-bind="fromFacility"></span></div>
            <div class="k">‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</div>
            <div class="v"><ul id="pdfToList" class="ul-compact"></ul></div>
            <div class="k">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠</div>
            <div class="v"><span data-bind="refDate"></span></div>
          </div>
        </div>
        <div id="printFooter"><span class="printed"></span><span class="pgn"></span></div>
        <div class="pdf-cols">
          <div class="col">
            <div class="pdf-section">
              <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h3>
              <div class="kv">
                <div class="k">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</div><div class="v"><span data-bind="pName"></span></div>
                <div class="k">‡∏≠‡∏≤‡∏¢‡∏∏</div><div class="v"><span data-bind="pAge"></span> ‡∏õ‡∏µ</div>
                <div class="k">HN</div><div class="v"><span data-bind="pHN"></span></div>
                <div class="k">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£</div><div class="v"><span data-bind="pCID"></span></div>
                <div class="k">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</div><div class="v"><span data-bind="pAddress"></span></div>
                <div class="k">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏´‡∏•‡∏±‡∏Å</div><div class="v"><span data-bind="careName"></span> (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå: <span data-bind="careRelation"></span>, ‡πÇ‡∏ó‡∏£: <span data-bind="careTel"></span>)</div>
              </div>
            </div>
            <div class="pdf-section">
              <h3>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå & ACP</h3>
              <p>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: <span data-bind="purposeList"></span></p>
              <p>ACP: <span data-bind="acpList"></span></p>
            </div>
          </div>
          <div class="col">
            <div class="pdf-section">
              <h3>‡∏à‡∏¥‡∏ï‡∏™‡∏±‡∏á‡∏Ñ‡∏°‚Äì‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì</h3>
              <p>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö: <span data-bind="informedBy"></span> | ‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢: <span data-bind="living"></span></p>
              <p>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£/‡∏´‡πà‡∏ß‡∏á‡∏Å‡∏±‡∏á‡∏ß‡∏•: <span data-bind="concerns"></span></p>
              <p id="pdfLinePerPatient">Perception (‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢): <span data-bind="perceptionPatient"></span></p>
              <p id="pdfLinePerFamily">Perception (‡∏ç‡∏≤‡∏ï‡∏¥): <span data-bind="perceptionFamily"></span></p>
              <p id="pdfLineConspiracy">Conspiracy of silence: <span data-bind="conspiracy"></span></p>
            </div>
            <div class="pdf-section">
              <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</h3>
              <p id="pdfLineDx">Dx: <span data-bind="dx"></span> | PPS: <span data-bind="pps"></span>% | GFR: <span data-bind="gfr"></span>% | Hct: <span data-bind="hct"></span>% | Alb: <span data-bind="alb"></span> g/dL</p>
              <p id="pdfLineSymptoms">‡∏≠‡∏≤‡∏Å‡∏≤‡∏£: ‡∏õ‡∏ß‡∏î‡∏ö‡∏£‡∏¥‡πÄ‡∏ß‡∏ì <span data-bind="painSite"></span> (PS <span data-bind="painScore"></span>/10); Dyspnea <span data-bind="dyspneaScore"></span>/10 (RR <span data-bind="vsRR"></span>/‡∏ô‡∏≤‡∏ó‡∏µ); ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ/‡∏≠‡∏≤‡πÄ‡∏à‡∏µ‡∏¢‡∏ô: <span data-bind="nausea"></span>; ‡∏≠‡∏∑‡πà‡∏ô‡πÜ: <span data-bind="others"></span></p>
              <p id="pdfLineVS">V/S: BP <span data-bind="bpSys"></span>/<span data-bind="bpDia"></span> mmHg; HR <span data-bind="hr"></span>/‡∏ô‡∏≤‡∏ó‡∏µ</p>
            </div>
          </div>
        </div>
        <div class="pdf-section">
          <h3>‡πÅ‡∏ú‡∏ô‡∏¢‡∏≤</h3>
          <ul id="pdfMeds"></ul>
          <p id="pdfTdd" class="muted"></p>
        </div>
        <div class="pdf-section">
          <h3>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</h3>
          <p><span data-bind="fuDate"></span> ‚Äî <span data-bind="fuSite"></span> (‡πÇ‡∏ó‡∏£ <span data-bind="fuTel"></span>)</p>
          
        </div>
        <div class="pdf-footer">
          <p>‡∏ú‡∏π‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: _____________________________ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ____________________</p>
        </div>
      </section>

      <div id="snack"></div>
    </main>

    <!-- html2pdf for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-YcsIPnp8nTKpWsyQufgqKp5r9mS1ANVmX8p1c+5f5m1tGqVf9y2o8aLVYF0i9T6Yg1n9lVfX8u5z6xq1F6s5Mg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="app.js"></script>
    <script src="med-calculator.js"></script>
  </body>
  </html>
